import{_ as pe}from"./Navbar.vue.82295224.js";import{g as J,r as w,o as s,c as g,h as c,w as i,a as m,n as R,q as e,a_ as A,t as S,s as T,d as C,S as de,ab as me,e as fe,Z as ve,F as B,m as M,P as Y,U as he,ag as _e,l as h,I as ee,b as l,j as ye,J as ge,a$ as be,E as xe,b0 as Ce,X as ke,b1 as $e,a6 as Re}from"./entry.fbf2c464.js";import{_ as te}from"./Badge.d9d2b649.js";import{_ as Se}from"./NSelect.vue.8ff29308.js";import{_ as Te}from"./CodeSnippets.vue.b63711e4.js";import{_ as oe}from"./NPanelGrids.eec702e8.js";import{_ as qe}from"./NCodeBlock.vue.bdc8bfdc.js";import{u as we}from"./editor.a4d83539.js";import{C as Z}from"./constants.d7bcda3c.js";import{_ as je}from"./PanelLeftRight.vue.5871de72.js";import"./client.495918a8.js";const Ee=m("div",{"x-divider":""},null,-1),ne=J({__name:"ServerRouteListItem",props:{item:{},index:{default:0}},setup(O){const V=w(!0);return(a,r)=>{const P=Y,N=te,q=ne;return s(),g("div",null,[(s(),c(me(a.item.routes?"button":e(fe)),{flex:"~ gap-2","w-full":"","items-center":"","hover-bg-active":"",px2:"",py1:"",class:R([{"bg-active":a.$route.query.path===a.item.route}]),style:de({paddingLeft:`calc(0.5rem + ${a.index*1.5}em)`}),to:{query:{path:a.item.route}},onClick:r[0]||(r[0]=U=>V.value=!e(V))},{default:i(()=>[m("div",{class:R({"w-12":!a.item.routes}),"flex-none":"","text-left":""},[a.item.type==="collection"?(s(),c(P,{key:0,icon:"carbon:chevron-right","mb0.5":"","transform-rotate":e(V)?90:0,transition:""},null,8,["transform-rotate"])):(s(),c(N,{key:1,class:R(("getRequestMethodClass"in a?a.getRequestMethodClass:e(A))(a.item.method||"*")),textContent:S((a.item.method||"*").toUpperCase())},null,8,["class","textContent"]))],2),m("span",{class:R({"flex items-center":a.item.routes}),"flex-auto":"","font-mono":"","text-sm":""},[a.item.type==="collection"?(s(),c(P,{key:0,title:`${a.item.routes?.length} routes`,icon:"carbon:folder",mr1:""},null,8,["title"])):T("",!0),C(" "+S(a.item.route),1)],2)]),_:1},8,["class","style","to"])),Ee,e(V)?ve(a.$slots,"default",{key:0},()=>[(s(!0),g(B,null,M(a.item.routes,U=>(s(),c(q,{key:U.filepath,item:U,index:a.index+1},null,8,["item","index"]))),128))]):T("",!0)])}}}),Ve={"h-full":"","w-full":"",flex:"~ col"},Ue={flex:"~ col gap-2","flex-none":"",p4:"","navbar-glass":""},Ne={flex:"~ gap2"},Pe={flex:"~ gap2","w-full":"","items-center":"",px4:"",pb2:"","text-center":"","text-sm":"",border:"b base"},Le=m("div",{"flex-auto":""},null,-1),Be={key:0,border:"b base","items-center":"",px4:"",py2:"",grid:"~ cols-[max-content_1fr] gap-2"},Oe={"text-right":"","font-mono":""},De={key:1,relative:""},Me={key:2,px4:"",py2:"",flex:"~ col gap-2",border:"b base"},Ie={border:"b base",flex:"~ gap2","items-center":"",px4:"",py2:""},Fe=m("div",null,"Response",-1),Ge={key:1,"text-xs":"",op50:""},We=m("div",{"flex-auto":""},null,-1),Ae=m("div",{op50:""}," Request finished in ",-1),He=J({__name:"ServerRouteDetails",props:{route:{type:Object,required:!0}},setup(O){const V=O,a=he(),r=_e({contentType:"text/plain",data:"",statusCode:200,error:void 0}),P=h(()=>r.contentType.includes("application/json")?"json":r.contentType.includes("text/html")?"html":r.contentType.includes("text/css")?"css":r.contentType.includes("text/javascript")?"javascript":r.contentType.includes("text/xml")||r.contentType.includes("application/xml")?"xml":"text"),N=h(()=>P.value==="json"?JSON.stringify(r.data,null,2):r.data),q=w(0),U=w(!1),_=w(!1),j=we(),D=h(()=>V.route.route?.split(/((?:\*\*)?:[\w_]+)/g)),p=h(()=>D.value?.filter(o=>o.startsWith(":")||o.startsWith("**:"))||[]),d=w(V.route.method||"GET"),L=w({}),b=w([{key:"",value:""}]),x=w([{key:"",value:""}]),f=w([{key:"Content-Type",value:"application/json"}]),E=h(()=>x.value.filter(({key:o})=>o).length),K=h(()=>f.value.filter(({key:o})=>o).length),H=h(()=>{const o={};for(let t=0;t<b.value.length;t++){const{key:n,value:v}=b.value[t];o[n]=v}return Object.keys(o)[0]?o:null}),se=h(()=>{let o=a.value?.devServer.url||"http://localhost";o.charAt(o.length-1)==="/"&&(o=o.slice(0,-1));const t=a.value?.devServer.port||3e3;return o.includes(`:${t}`)?o:`${o}:${t}`}),I=h(()=>{let o=new URLSearchParams(Object.fromEntries(x.value.filter(({key:v})=>v).map(({key:v,value:k})=>[v,k]))).toString();o&&(o=`?${o}`);const t=(D.value?.map(v=>(v.startsWith(":")||v.startsWith("**:"))&&L.value[v]||v).join("")||"")+o;let n=a.value?.app.baseURL||"";return(n==="./"||n===".")&&(n=""),n.endsWith("/")&&(n=n.slice(0,-1)),n+t}),ae=h(()=>se.value+I.value);async function Q(){_.value=!0,U.value=!0,Object.assign(r,{lang:"text",contentType:"",data:"",content:"",error:void 0});const o=Date.now();try{r.data=await $fetch(ae.value,{method:d.value.toUpperCase(),headers:Object.fromEntries(f.value.filter(({key:t,value:n})=>t&&n).map(({key:t,value:n})=>[t,n])),query:Object.fromEntries(x.value.filter(({key:t,value:n})=>t&&n).map(({key:t,value:n})=>[t,n])),body:H.value,onResponse({response:t}){r.contentType=(t.headers.get("content-type")||"").toString().toLowerCase().trim(),r.statusCode=t.status},onResponseError(t){r.error=t.response._data,r.data=t.response._data}})}catch{}U.value=!1,q.value=Date.now()-o}const X=h(()=>{const o=[],t=[],n=f.value.filter(({key:k,value:$})=>k&&$&&!(k==="Content-Type"&&$==="application/json")).map(({key:k,value:$})=>`  '${k}': '${$}'`).join(`,
`);d.value.toUpperCase()!=="GET"&&t.push(`method: '${d.value.toUpperCase()}'`),n&&t.push(`headers: {
${n}
}`),H.value&&t.push(`body: ${JSON.stringify(H.value,null,2)}`);const v=t.length?`, {
${t.join(`,
`).split(`
`).map(k=>`  ${k}`).join(`
`)}
}`:"";return o.push({name:"useFetch",lang:"javascript",docs:Z.nuxt.useFetch,code:`const { data, pending, error, refresh } = useFetch('${I.value}'${v})`}),o.push({name:"$fetch",lang:"javascript",docs:Z.nuxt.$fetch,code:`await $fetch('${I.value}'${v})`}),o}),y=w(p.value.length?"params":"query"),F=h(()=>{if(y.value==="query")return x.value;if(y.value==="body")return b.value;if(y.value==="headers")return f.value}),re=["GET","POST","PUT","PATCH","DELETE","HEAD"];return(o,t)=>{const n=ye,v=Se,k=ge,$=Y,le=Te,ue=oe,ie=be,z=te,ce=qe;return s(),g("div",Ve,[m("div",Ue,[m("div",Ne,[O.route.method?(s(),c(n,{key:0,class:R(("getRequestMethodClass"in o?o.getRequestMethodClass:e(A))(e(d))),"pointer-events-none":"",tabindex:"-1"},{default:i(()=>[C(S(e(d).toUpperCase()),1)]),_:1},8,["class"])):(s(),c(v,{key:1,modelValue:e(d),"onUpdate:modelValue":t[0]||(t[0]=u=>ee(d)?d.value=u:null),class:R(("getRequestMethodClass"in o?o.getRequestMethodClass:e(A))(e(d)))},{default:i(()=>[(s(),g(B,null,M(re,u=>m("option",{key:u,class:R(("getRequestMethodClass"in o?o.getRequestMethodClass:e(A))(u))},S(u.toUpperCase()),3)),64))]),_:1},8,["modelValue","class"])),l(k,{"model-value":e(I),disabled:"","flex-auto":"","font-mono":"",p:"x5 y2",n:"primary xs"},null,8,["model-value"]),l(n,{n:"primary solid",onClick:Q},{default:i(()=>[l($,{icon:"carbon:send"})]),_:1})])]),m("div",Pe,[e(p).length?(s(),c(n,{key:0,class:R(e(y)==="params"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[1]||(t[1]=u=>y.value="params")},{default:i(()=>[l($,{icon:"i-carbon-text-selection"}),C(" Params ("+S(e(p).length)+") ",1)]),_:1},8,["class"])):T("",!0),l(n,{class:R(e(y)==="query"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[2]||(t[2]=u=>y.value="query")},{default:i(()=>[l($,{icon:"i-carbon-help"}),C(" Query "+S(e(E)?`(${e(E)})`:""),1)]),_:1},8,["class"]),e(d)!=="GET"?(s(),c(n,{key:1,class:R(e(y)==="body"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[3]||(t[3]=u=>y.value="body")},{default:i(()=>[l($,{icon:"i-carbon-document"}),C(" Body ")]),_:1},8,["class"])):T("",!0),l(n,{class:R(e(y)==="headers"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[4]||(t[4]=u=>y.value="headers")},{default:i(()=>[l($,{icon:"i-carbon-html-reference"}),C(" Headers "+S(e(K)?`(${e(K)})`:""),1)]),_:1},8,["class"]),l(n,{class:R(e(y)==="snippet"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[5]||(t[5]=u=>y.value="snippet")},{default:i(()=>[l($,{icon:"carbon:code"}),C(" Snippets ")]),_:1},8,["class"]),Le,l(n,{icon:"carbon-launch",onClick:t[6]||(t[6]=u=>e(j)(O.route.filepath))},{default:i(()=>[C(" Open in Editor ")]),_:1})]),e(y)==="params"?(s(),g("div",Be,[(s(!0),g(B,null,M(e(p),u=>(s(),g(B,{key:u},[m("div",Oe,S(u),1),l(k,{modelValue:e(L)[u],"onUpdate:modelValue":G=>e(L)[u]=G,placeholder:u,"flex-1":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])],64))),128))])):T("",!0),e(y)==="snippet"?(s(),g("div",De,[e(X).length?(s(),c(le,{key:0,border:"b base","code-snippets":e(X)},null,8,["code-snippets"])):T("",!0)])):e(F)?(s(),g("div",Me,[(s(!0),g(B,null,M(e(F),(u,G)=>(s(),g("div",{key:G,flex:"~ gap-2","justify-around":""},[l(k,{modelValue:u.key,"onUpdate:modelValue":W=>u.key=W,placeholder:"Key","flex-1":"","font-mono":"",n:"sm"},null,8,["modelValue","onUpdate:modelValue"]),l(k,{modelValue:u.value,"onUpdate:modelValue":W=>u.value=W,placeholder:"Value","flex-1":"","font-mono":"",n:"sm"},null,8,["modelValue","onUpdate:modelValue"]),l(n,{n:"red",onClick:W=>e(F).splice(G,1)},{default:i(()=>[l($,{icon:"carbon:delete"})]),_:2},1032,["onClick"])]))),128)),m("div",null,[l(n,{icon:"carbon-add",n:"sm primary",my1:"","px-3":"",onClick:t[7]||(t[7]=u=>e(F).push({key:"",value:""}))},{default:i(()=>[C(" Add ")]),_:1})])])):T("",!0),e(_)?e(U)?(s(),c(ie,{key:4,"z-10":"","flex-auto":"","backdrop-blur":""},{default:i(()=>[C(" Fetching... ")]),_:1})):(s(),g(B,{key:5},[m("div",Ie,[Fe,e(r).error?(s(),c(z,{key:0,"bg-red-400:10":"","text-red-400":""},{default:i(()=>[C(" Error ")]),_:1})):T("",!0),l(z,{class:R({"bg-orange-400:10 text-orange-400":e(r).error,"bg-green-400:10 text-green-400":!e(r).error})},{default:i(()=>[C(S(e(r).statusCode),1)]),_:1},8,["class"]),e(r).contentType?(s(),g("code",Ge,S(e(r).contentType),1)):T("",!0),We,Ae,l(z,{"bg-green-400:10":"","text-green-400":""},{default:i(()=>[C(S(e(q))+" ms ",1)]),_:1})]),l(ce,{"flex-auto":"","overflow-auto":"","py-2":"",code:e(N),lang:e(P)},null,8,["code","lang"])],64)):(s(),c(ue,{key:3},{default:i(()=>[l(n,{n:"primary",onClick:Q},{default:i(()=>[l($,{icon:"carbon:send"}),C(" Send request ")]),_:1})]),_:1}))])}}}),ze={flex:"~ gap1","text-sm":""},Je={key:0,op50:""},Ke={op50:""},Qe=m("span",{op75:""},"Select a route to start",-1),ut=J({__name:"server-routes",setup(O){const V=xe(),a=Ce(),r=h(()=>{const _=[],j=(p,d)=>{p.routes=p.routes||[],p.routes.push(d)};return a.value?.forEach(p=>{const d=p.filepath.split("/"),L=d.slice(0,-1).slice(d.indexOf("server")+1);let b=null;if(L.forEach(x=>{const f=b?b.routes?.find(E=>E.route===x):_.find(E=>E.route===x);if(f)b=f;else{const E={route:x,filepath:x.replace(/\W/g,"-").toLowerCase(),type:"collection",routes:[]};b?j(b,E):_.push(E),b=E}}),p.type==="runtime"){const x=_.find(f=>f.route==="runtime");if(x)j(x,p);else{const f={route:"runtime",filepath:"runtime",type:"collection",routes:[p]};_.push(f)}}else b?j(b,p):_.push(p)}),_.length===1?_[0].routes??[]:_}),P=h(()=>new ke(a.value||[],{keys:["method","route"],shouldSort:!0})),N=h(()=>a.value?.find(_=>_.route===V.query?.path)),q=w(""),U=h(()=>a.value?q.value?P.value.search(q.value).map(j=>j.item):a.value:[]);return(_,j)=>{const D=pe,p=ne,d=He,L=Re,b=oe,x=je;return s(),c(x,null,{left:i(()=>[l(D,{search:e(q),"onUpdate:search":j[0]||(j[0]=f=>ee(q)?q.value=f:null),pb2:""},{default:i(()=>[m("div",ze,[e(q)?(s(),g("span",Je,S(e(U).length)+" matched · ",1)):T("",!0),m("span",Ke,S(e(a)?.length)+" routes in total",1)])]),_:1},8,["search"]),(s(!0),g(B,null,M(e(r),f=>(s(),c(p,{key:f.filepath,item:f},null,8,["item"]))),128))]),right:i(()=>[(s(),c($e,{max:10},[e(N)?(s(),c(d,{key:e(N).filepath,route:e(N)},null,8,["route"])):T("",!0)],1024)),e(N)?T("",!0):(s(),c(b,{key:0},{default:i(()=>[l(L,{px6:"",py2:""},{default:i(()=>[Qe]),_:1})]),_:1}))]),_:1})}}});export{ut as default};
